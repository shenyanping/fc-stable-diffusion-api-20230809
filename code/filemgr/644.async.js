"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[644],{68996:function(Z,C,e){e.d(C,{r:function(){return s}});var R=e(97857),r=e.n(R),m=e(86074);function s(d){var k=d.disabled,W=d.children,U=d.message;return(0,m.jsxs)("div",{style:r()({position:"relative"},k?{cursor:"not-allowed",display:"block",maxHeight:"100vh",overflow:"hidden"}:{}),children:[k&&(0,m.jsx)("div",{style:{position:"absolute",fontWeight:"bold",zIndex:1,transform:"translate(0, -50%)",top:"50%",left:0,right:0,textAlign:"center"},children:U||"\u60A8\u672A\u6302\u8F7D NAS\uFF0C\u65E0\u6CD5\u5F00\u542F\u6587\u4EF6\u7BA1\u7406\u529F\u80FD\u3002"}),(0,m.jsx)("div",{style:k?{pointerEvents:"none",filter:"opacity(0.5) grayscale(1)"}:{},children:W})]})}},68797:function(Z,C,e){e.d(C,{Q:function(){return V}});var R=e(97857),r=e.n(R),m=e(15009),s=e.n(m),d=e(99289),k=e.n(d),W=e(5574),U=e.n(W),G=e(36147),K=e(71577),L=e(62435),I=e(86074);function V(O){var Q=O.modalProps,A=O.buttonProps,Y=O.children,B=O.beforeRequest,D=O.afterRequest,g=O.request,z=O.setVisibleCallback,N=L.useState(!1),$=U()(N,2),H=$[0],a=$[1];return L.useEffect(function(){z&&z(a)},[a]),(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(G.Z,r()(r()({open:H,onCancel:function(){return a(!1)},maskClosable:!0,destroyOnClose:!0,onOk:k()(s()().mark(function o(){var c;return s()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(g){n.next=2;break}return n.abrupt("return");case 2:return B&&B(),n.prev=3,n.next=6,g();case 6:c=n.sent,c.success?(D&&D(!0),a(!1)):D&&D(!1,"".concat(c.errMsg)),n.next=13;break;case 10:n.prev=10,n.t0=n.catch(3),D&&D(!1,"".concat(n.t0));case 13:case"end":return n.stop()}},o,null,[[3,10]])})),okButtonProps:g?{}:{style:{display:"none"}}},Q),{},{children:H&&Y})),(0,I.jsx)(K.ZP,r()({onClick:function(){return a(!0)}},A))]})}},70507:function(Z,C,e){var R=e(50942),r=e(6154);r.Z.interceptors.response.use(function(m){return m},function(m){return m.response&&(m.response.status===401&&R.m8.push("/login"),m.response.status!==200)?m.response:Promise.reject(m)}),C.Z=r.Z},61039:function(Z,C,e){e.d(C,{$R:function(){return B},C7:function(){return k},L6:function(){return K},MB:function(){return H},RN:function(){return N},Ri:function(){return g},Yd:function(){return U},ap:function(){return A},cy:function(){return O},jW:function(){return I}});var R=e(15009),r=e.n(R),m=e(99289),s=e.n(m),d=e(70507);function k(a,o){return W.apply(this,arguments)}function W(){return W=s()(r()().mark(function a(o,c){var y;return r()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,d.Z.get("/api/file/list",{params:{path:o,dir_size:c}});case 2:return y=u.sent,u.abrupt("return",y.data);case 4:case"end":return u.stop()}},a)})),W.apply(this,arguments)}function U(a){return G.apply(this,arguments)}function G(){return G=s()(r()().mark(function a(o){var c;return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,d.Z.delete("/api/file?path=".concat(o));case 2:return c=n.sent,n.abrupt("return",c.data);case 4:case"end":return n.stop()}},a)})),G.apply(this,arguments)}function K(a){return L.apply(this,arguments)}function L(){return L=s()(r()().mark(function a(o){var c;return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,d.Z.put("/api/folder",null,{params:{path:o}});case 2:return c=n.sent,n.abrupt("return",c.data);case 4:case"end":return n.stop()}},a)})),L.apply(this,arguments)}function I(a,o){return V.apply(this,arguments)}function V(){return V=s()(r()().mark(function a(o,c){var y;return r()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,d.Z.post("/api/file/move",null,{params:{src:o,dst:c}});case 2:return y=u.sent,u.abrupt("return",y.data);case 4:case"end":return u.stop()}},a)})),V.apply(this,arguments)}function O(a,o){return Q.apply(this,arguments)}function Q(){return Q=s()(r()().mark(function a(o,c){var y;return r()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,d.Z.post("/api/file/copy",null,{params:{src:o,dst:c}});case 2:return y=u.sent,u.abrupt("return",y.data);case 4:case"end":return u.stop()}},a)})),Q.apply(this,arguments)}function A(a){return Y.apply(this,arguments)}function Y(){return Y=s()(r()().mark(function a(o){var c;return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,d.Z.get("/api/file/size",{params:{path:o}});case 2:return c=n.sent,n.abrupt("return",c.data);case 4:case"end":return n.stop()}},a)})),Y.apply(this,arguments)}function B(a,o){return D.apply(this,arguments)}function D(){return D=s()(r()().mark(function a(o,c){var y;return r()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,d.Z.post("/api/file/zip",{files:o,dst:c});case 2:return y=u.sent,u.abrupt("return",y.data);case 4:case"end":return u.stop()}},a)})),D.apply(this,arguments)}function g(a,o){return z.apply(this,arguments)}function z(){return z=s()(r()().mark(function a(o,c){var y;return r()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,d.Z.post("/api/file/unzip",null,{params:{src:o,dst:c}});case 2:return y=u.sent,u.abrupt("return",y.data);case 4:case"end":return u.stop()}},a)})),z.apply(this,arguments)}function N(a){return $.apply(this,arguments)}function $(){return $=s()(r()().mark(function a(o){var c;return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,d.Z.get("/api/file/preview",{params:{path:o}});case 2:return c=n.sent,n.abrupt("return",c.data);case 4:case"end":return n.stop()}},a)})),$.apply(this,arguments)}function H(a){return"/api/file?path=".concat(encodeURIComponent(a))}},43331:function(Z,C,e){e.d(C,{Vz:function(){return u},qU:function(){return se},tw:function(){return te}});var R=e(15009),r=e.n(R),m=e(99289),s=e.n(m),d=e(25098),k=e.n(d),W=e(28785),U=e.n(W),G=e(48374),K=e.n(G),L=e(31996),I=e.n(L),V=e(26037),O=e.n(V),Q=e(12444),A=e.n(Q),Y=e(72004),B=e.n(Y),D=e(9783),g=e.n(D),z=function(){function P(h){A()(this,P),g()(this,"maxRunning",void 0),g()(this,"running",void 0),this.maxRunning=h,this.running=0}return B()(P,[{key:"getToken",value:function(){var h=s()(r()().mark(function _(){var p=this;return r()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(this.running>=this.maxRunning)){t.next=3;break}return t.next=3,new Promise(function(w){var M=setInterval(function(){p.running<p.maxRunning&&(clearInterval(M),w(void 0))},100)});case 3:this.running++;case 4:case"end":return t.stop()}},_,this)}));function f(){return h.apply(this,arguments)}return f}()},{key:"releaseToken",value:function(){this.running--}}]),P}(),N=e(61039),$=e(70507);function H(P,h,f){return a.apply(this,arguments)}function a(){return a=s()(r()().mark(function P(h,f,_){var p;return r()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,$.Z.post("/api/upload/chunk?filename=".concat(encodeURIComponent(h),"&start=").concat(encodeURIComponent(f)),_);case 2:return p=t.sent,t.abrupt("return",p.data);case 4:case"end":return t.stop()}},P)})),a.apply(this,arguments)}function o(P,h,f,_,p){return c.apply(this,arguments)}function c(){return c=s()(r()().mark(function P(h,f,_,p,i){return r()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,new Promise(function(M,b){var E=new WebSocket("".concat(location.protocol.replace("http","ws"),"//").concat(location.hostname,":").concat(location.port,"/api/upload/url?filename=").concat(encodeURIComponent(h),"&url=").concat(encodeURIComponent(f)));i&&i(E),E.onerror=b,E.onopen=function(){E.send("client send hi")};var v=!1,j="";E.onmessage=function(X){try{var J=JSON.parse(X.data),T=J.current,re=J.total,F=J.success,x=J.errMsg;F===!0?v=!0:F===!1?(v=!1,j=x):_(T,re)}catch(ee){console.error(ee),console.log(X)}},E.onclose=function(){M(void 0),E.close(),p(v,j)}});case 2:return w.abrupt("return",{success:!0});case 3:case"end":return w.stop()}},P)})),c.apply(this,arguments)}var y=new z(32),n=function(){function P(){A()(this,P),g()(this,"key",""),g()(this,"type","unknown"),g()(this,"target",""),g()(this,"current",0),g()(this,"total",0),g()(this,"finished",!1),g()(this,"error",""),g()(this,"cancel",!1),this.key=Math.random().toString(36).substr(2,8)}return B()(P,[{key:"getKey",value:function(){return this.key}},{key:"getCurrent",value:function(){return this.current}},{key:"getTotal",value:function(){return this.total}},{key:"getProgress",value:function(){return this.total===0?0:this.current/this.total}},{key:"getFileName",value:function(){return this.target}},{key:"isFinished",value:function(){return this.finished}},{key:"getError",value:function(){return this.error}},{key:"run",value:function(){this.cancel=!1,this.error=""}},{key:"stop",value:function(){this.cancel=!0,this.error="\u7528\u6237\u53D6\u6D88"}}]),P}(),u=function(P){I()(f,P);var h=O()(f);function f(_,p){var i;return A()(this,f),i=h.call(this),g()(k()(i),"type","chunk"),g()(k()(i),"file",void 0),i.file=_,i.target=p,i}return B()(f,[{key:"uploadWithRetry",value:function(){var _=s()(r()().mark(function i(t,w,M){var b,E,v;return r()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:b=5,E="";case 2:if(!(b>0)){l.next=23;break}return l.prev=3,l.next=6,H(t,w,M);case 6:if(v=l.sent,v.success){l.next=13;break}return b--,E=v.errMsg,l.abrupt("continue",2);case 13:return l.abrupt("return",{success:!0});case 14:l.next=21;break;case 16:return l.prev=16,l.t0=l.catch(3),b--,E=l.t0.toString(),l.abrupt("continue",2);case 21:l.next=2;break;case 23:return l.abrupt("return",{success:!1,errMsg:"retry times exceed, still got error ".concat(E)});case 24:case"end":return l.stop()}},i,null,[[3,16]])}));function p(i,t,w){return _.apply(this,arguments)}return p}()},{key:"run",value:function(){var _=s()(r()().mark(function i(){var t=this,w,M,b,E,v,j,l,X;return r()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.next=2,U()(K()(f.prototype),"run",this).call(this);case 2:w=this.file,M=this.target,this.total=w.size,b=1048576,E=Math.ceil(this.file.size/b),v=[],j=r()().mark(function re(){var F,x,ee,ae;return r()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(!t.cancel){S.next=2;break}return S.abrupt("return","break");case 2:return F=l*b,x=Math.min(F+b,w.size),ee=w.slice(F,x),ae=x-F,S.next=8,y.getToken();case 8:if(v.push(s()(r()().mark(function ue(){var ne;return r()().wrap(function(q){for(;;)switch(q.prev=q.next){case 0:return q.next=2,t.uploadWithRetry(M,F,ee);case 2:ne=q.sent,t.current+=ae,y.releaseToken(),!ne.success&&!t.cancel&&(t.error=ne.errMsg);case 6:case"end":return q.stop()}},ue)}))()),!(t.error||t.cancel)){S.next=11;break}return S.abrupt("return","break");case 11:case"end":return S.stop()}},re)}),l=0;case 10:if(!(l<E)){T.next=18;break}return T.delegateYield(j(),"t0",12);case 12:if(X=T.t0,X!=="break"){T.next=15;break}return T.abrupt("break",18);case 15:l++,T.next=10;break;case 18:return T.next=20,Promise.all(v);case 20:if(!this.cancel){T.next=22;break}return T.abrupt("return");case 22:this.error||(this.finished=!0);case 23:case"end":return T.stop()}},i,this)}));function p(){return _.apply(this,arguments)}return p}()},{key:"stop",value:function(){U()(K()(f.prototype),"stop",this).call(this)}}]),f}(n),te=function(P){I()(f,P);var h=O()(f);function f(_,p){var i;return A()(this,f),i=h.call(this),g()(k()(i),"type","url"),g()(k()(i),"url",void 0),g()(k()(i),"ws",void 0),i.url=_,i.target=p,i}return B()(f,[{key:"run",value:function(){var _=s()(r()().mark(function i(){var t=this;return r()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return M.next=2,U()(K()(f.prototype),"run",this).call(this);case 2:return M.next=4,o(this.target,this.url,function(b,E){t.current=b,t.total=E},function(b,E){t.finished=b,!t.cancel&&(t.error=E||"")},function(b){return t.ws=b});case 4:case"end":return M.stop()}},i,this)}));function p(){return _.apply(this,arguments)}return p}()},{key:"stop",value:function(){var p;U()(K()(f.prototype),"stop",this).call(this),this===null||this===void 0||(p=this.ws)===null||p===void 0||p.close()}}]),f}(n),se=function(P){I()(f,P);var h=O()(f);function f(){var _;A()(this,f);for(var p=arguments.length,i=new Array(p),t=0;t<p;t++)i[t]=arguments[t];return _=h.call.apply(h,[this].concat(i)),g()(k()(_),"type","url_unzip"),_}return B()(f,[{key:"run",value:function(){var _=s()(r()().mark(function i(){var t=this,w,M,b;return r()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return this.cancel=!1,this.error="",v.next=4,o(this.target,this.url,function(j,l){t.current=j,t.total=l},function(j,l){t.finished=j,!t.cancel&&(t.error=l||"")},function(j){return t.ws=j});case 4:if(w=v.sent,M=w.success,!(M&&!this.cancel)){v.next=17;break}return v.next=9,(0,N.Ri)(this.target,this.target.slice(0,-4));case 9:if(b=v.sent,b.success){v.next=14;break}this.error=b.errMsg,v.next=17;break;case 14:return v.next=16,(0,N.Yd)(this.target);case 16:this.finished=!0;case 17:case"end":return v.stop()}},i,this)}));function p(){return _.apply(this,arguments)}return p}()}]),f}(te)},92380:function(Z,C,e){e.d(C,{t:function(){return R}});function R(r){for(var m=["B","KB","MB","GB","TB"],s=0;r>1024;)r/=1024,s++;return"".concat(r.toFixed(2)," ").concat(m[s])}},85504:function(Z,C,e){e.d(C,{_:function(){return m},i:function(){return r}});var R=e(62435),r={info:void 0,tasks:[],setCtx:function(){}},m=R.createContext(r)},53371:function(Z,C,e){e.d(C,{Dy:function(){return m},Us:function(){return r},XP:function(){return R}});function R(s){var d=s.lastIndexOf("/");return d===-1?"/":s.substring(0,d)}function r(s){var d=s.lastIndexOf("/");return d===-1?s:s.substring(d+1)}function m(){for(var s=arguments.length,d=new Array(s),k=0;k<s;k++)d[k]=arguments[k];return d.join("/").replace(/\/+/g,"/")}}}]);
