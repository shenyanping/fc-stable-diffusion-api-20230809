"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[448],{25864:function(Oe,ne,n){n.d(ne,{E:function(){return je}});var ve=n(97857),U=n.n(ve),re=n(92380),y=n(85504),he=n(53371),F=n(90105),ge=n(18629),B=n(42075),me=n(26196),P=n(94139),$=n(69814),z=n(71577),se=n(57950),xe=n(62435),D=n(86074);function J(Z){var R=Z.task,M=Z.onRemove,S=R.getFileName(),L=Math.round(R.getProgress()*1e4)/100,c=R.getCurrent(),ae=R.getTotal(),w=R.getError(),W=R.isFinished();return(0,D.jsxs)(B.Z,{direction:"vertical",style:{width:"100%"},size:0,children:[(0,D.jsxs)(B.Z,{style:{width:"100%",justifyContent:"space-between"},children:[(0,D.jsx)(me.Z.Text,{strong:!0,children:(0,D.jsx)(P.Z,{title:S,children:(0,he.Us)(S)})}),(0,D.jsxs)("span",{children:[(0,re.t)(c)," / ",(0,re.t)(ae)]})]}),(0,D.jsx)($.Z,{percent:L,status:w?"exception":W?"success":void 0}),w&&(0,D.jsx)("span",{style:{color:"red"},children:w}),(0,D.jsxs)(B.Z,{style:{justifyContent:"flex-end",width:"100%"},children:[(0,D.jsx)(z.ZP,{size:"small",onClick:function(){M()},children:"\u5220\u9664\u8BB0\u5F55"}),(0,D.jsx)(z.ZP,{size:"small",danger:!0,onClick:function(){R.stop()},children:"\u53D6\u6D88\u4E0A\u4F20"}),(0,D.jsx)(z.ZP,{size:"small",disabled:!w,onClick:function(){R.run()},children:"\u91CD\u65B0\u4E0A\u4F20"})]})]})}function je(){var Z=xe.useContext(y._),R=Z.tasks,M=Z.setCtx,S=F.Z();return ge.Z(S,200),(0,D.jsx)(se.Z,{header:(0,D.jsx)("span",{style:{color:"#ed7075"},children:"\u4E0A\u4F20\u8FC7\u7A0B\u4E2D\u8BF7\u52FF\u5237\u65B0\u9875\u9762"}),dataSource:R,renderItem:function(c){return(0,D.jsx)(se.Z.Item,{children:(0,D.jsx)(J,{task:c,onRemove:function(){M(function(w){var W;return U()(U()({},w),{},{tasks:w==null||(W=w.tasks)===null||W===void 0?void 0:W.filter(function(V){return V.key!==c.key})})})}})})},locale:{emptyText:"\u6682\u65E0\u4E0A\u4F20\u4EFB\u52A1"}})}},87164:function(Oe,ne,n){n.r(ne),n.d(ne,{default:function(){return yt}});var ve=n(9783),U=n.n(ve),re=n(97857),y=n.n(re),he=n(15009),F=n.n(he),ge=n(99289),B=n.n(ge),me=n(5574),P=n.n(me),$=n(61039),z=n(85504),se=n(9957),xe=n(71965),D=n(3991),J=n(22821),je=n(83204),Z=n(33009),R=n(42075),M=n(79531),S=n(71577),L=n(57950),c=n(62435),ae=n(68996),w=n(92380),W=n(93613),V=n(26911),pe=n(19478),Pe=n(57132),De=n(48689),ke=n(43384),Te=n(75081),Le=n(71230),Ce=n(15746),Se=n(63232),we=n(36147),ue=n(26196),Be=n(76306),Ie=n(93179),Ue={"vertical-center":"vertical-center___gvLOV"},e=n(86074);function ze(t){return(0,e.jsx)("div",{className:Ue["vertical-center"],children:t.children})}var We=(0,c.memo)(ze),Ke=n(23430);function Ne(t){var s=t.path;return(0,e.jsx)("a",{href:(0,$.MB)(s),target:"_blank",rel:"noreferrer",children:(0,e.jsx)(S.ZP,{icon:(0,e.jsx)(Ke.Z,{}),type:"text",title:"\u4E0B\u8F7D"})})}var He=n(13769),G=n.n(He),Qe=n(77123),K=n(68797),Ve=["path","beforeRequest","afterRequest","loading"];function Ge(t){var s=t.path,i=t.beforeRequest,l=t.afterRequest,x=t.loading,j=G()(t,Ve),g=c.useState(""),v=P()(g,2),C=v[0],m=v[1];return c.useEffect(function(){return m(s)},[s]),(0,e.jsx)(K.Q,{modalProps:{title:"\u91CD\u547D\u540D\u6587\u4EF6",okText:"\u91CD\u547D\u540D",okButtonProps:{loading:x}},buttonProps:y()({title:"\u91CD\u547D\u540D",icon:(0,e.jsx)(Qe.Z,{}),type:"text",loading:x},j),beforeRequest:i,afterRequest:l,request:B()(F()().mark(function f(){return F()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,(0,$.jW)(s,C);case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},f)})),children:(0,e.jsx)(M.Z,{value:C,onChange:function(o){var u;return m((o==null||(u=o.target)===null||u===void 0?void 0:u.value)||"")},style:{width:"100%"}})})}var O=n(53371),$e=n(27461);function Ye(t){var s=t.file,i=t.beforeRequest,l=t.afterRequest,x=t.loading,j=c.useState(""),g=P()(j,2),v=g[0],C=g[1],m=c.useState(""),f=P()(m,2),o=f[0],u=f[1];return c.useEffect(function(){C(s.path),u("".concat((0,O.XP)(s.path)))},[s.path]),(0,e.jsx)(K.Q,{buttonProps:{icon:(0,e.jsx)($e.Z,{}),disabled:!s.name.endsWith(".zip"),type:"text",title:"\u89E3\u538B\u6587\u4EF6",loading:x},modalProps:{title:"\u89E3\u538B\u6587\u4EF6",okText:"\u89E3\u538B",okButtonProps:{loading:x}},request:B()(F()().mark(function a(){return F()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,(0,$.Ri)(v,o);case 2:return h.abrupt("return",h.sent);case 3:case"end":return h.stop()}},a)})),beforeRequest:i,afterRequest:l,children:(0,e.jsxs)(R.Z,{direction:"vertical",style:{width:"100%"},children:[(0,e.jsx)(ue.Z.Text,{children:"\u9009\u62E9\u89E3\u538B\u5230\u7684\u76EE\u5F55"}),(0,e.jsx)(M.Z,{addonBefore:"\u8981\u89E3\u538B\u7684\u6587\u4EF6",value:v,onChange:function(r){var h;return C((r==null||(h=r.target)===null||h===void 0?void 0:h.value)||"")},disabled:!0}),(0,e.jsx)(M.Z,{addonBefore:"\u89E3\u538B\u5230\u6587\u4EF6\u5939",value:o,onChange:function(r){var h;return u((r==null||(h=r.target)===null||h===void 0?void 0:h.value)||"")}})]})})}var Xe={item:"item___RAKFG"};function qe(t){var s=t.path,i=D.Z(B()(F()().mark(function m(){return F()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,(0,$.RN)(s);case 2:return o.abrupt("return",o.sent);case 3:case"end":return o.stop()}},m)})),{manual:!0}),l=i.data,x=i.loading,j=i.run,g=c.useMemo(function(){return s.split(".").pop()||""},[s]),v=c.useMemo(function(){return{js:"javascript",css:"css",py:"python",ts:"typescript",tsx:"typescript",htm:"html",md:"markdown",sh:"bash"}[g]||g},[g]),C=c.useMemo(function(){return["jpg","jpeg","png","bmp","svg","svgz","gif","ico","icon","webp"].indexOf(g)!==-1},[g]);return c.useEffect(function(){C===!1&&j()},[C,j]),C?(0,e.jsx)("div",{style:{textAlign:"center"},children:(0,e.jsx)(ke.Z,{src:(0,$.MB)(s),style:{height:"70vh"}})}):(0,e.jsx)(Te.Z,{spinning:x,children:(0,e.jsx)("div",{style:{maxHeight:"70vh",overflow:"auto"},children:(0,e.jsx)(Ie.Z,{language:v,children:(l!=null&&l.success?l==null?void 0:l.preview:l==null?void 0:l.errMsg)||""})})})}function Je(t){var s=t.file,i=t.run,l=t.currentPath,x=t.showDirSize,j=t.loading,g=t.setLoading,v=t.setLoadingFinished,C=t.setCache,m=t.selected,f=t.onSelect;return(0,e.jsxs)(Le.Z,{style:{width:"100%"},children:[(0,e.jsx)(Ce.Z,{span:1,children:(0,e.jsx)(We,{children:(0,e.jsx)(Se.Z,{checked:m,onChange:function(u){var a;return f(u==null||(a=u.target)===null||a===void 0?void 0:a.checked)}})})}),(0,e.jsx)(Ce.Z,{span:17,children:(0,e.jsx)("div",y()(y()({className:Xe.item},s.is_dir?{onClick:function(){i("".concat(l.replace(/([/ ]*)$/g,""),"/").concat(s.name))}}:{onClick:function(){we.Z.info({title:s.name,content:(0,e.jsx)(qe,{path:s.path}),width:"80vw",closable:!0,maskClosable:!0,okButtonProps:{style:{display:"none"}}})}}),{},{children:(0,e.jsxs)(ue.Z.Text,{ellipsis:{tooltip:s.name},style:{width:"70%"},children:[s.is_dir?(0,e.jsx)(W.Z,{style:{marginRight:"1em",color:"#869aa4"}}):(0,e.jsx)(V.Z,{style:{marginRight:"1em",color:"#869aa4"}}),s.name]})}))}),(0,e.jsx)(Ce.Z,{span:6,children:(0,e.jsxs)(R.Z,{align:"center",style:{justifyContent:"end",width:"100%"},children:[(x||!s.is_dir)&&(0,w.t)(s.size),!s.is_dir&&(0,e.jsx)(Ye,{file:s,loading:j,beforeRequest:g,afterRequest:function(u,a){u?Z.Z.success({message:"\u89E3\u538B\u6210\u529F"}):Z.Z.error({message:"\u89E3\u538B\u5931\u8D25",description:a}),v(),i(l)}}),!s.is_dir&&(0,e.jsx)(Ne,{path:s.path}),(0,e.jsx)(S.ZP,{icon:(0,e.jsx)(pe.Z,{}),type:"text",title:"\u526A\u5207",onClick:function(){C({file:[s.path],type:"cut"})}}),(0,e.jsx)(S.ZP,{icon:(0,e.jsx)(Pe.Z,{}),type:"text",title:"\u590D\u5236",onClick:function(){C({file:[s.path],type:"copy"})}}),(0,e.jsx)(Ge,{path:s.path,loading:j,beforeRequest:g,afterRequest:function(u,a){u?Z.Z.success({message:"\u91CD\u547D\u540D\u6210\u529F"}):Z.Z.error({message:"\u91CD\u547D\u540D\u5931\u8D25",description:a}),v(),i(l)}}),(0,e.jsx)(Be.Z,{title:"\u786E\u8BA4\u5220\u9664\u6587\u4EF6?",description:(0,e.jsxs)(ue.Z.Text,{children:["\u6587\u4EF6",(0,e.jsx)(ue.Z.Text,{code:!0,style:{margin:"0 0.5em"},children:s.name}),"\u5220\u9664\u540E\u4E0D\u53EF\u6062\u590D"]}),onConfirm:B()(F()().mark(function o(){var u;return F()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return g(),r.prev=1,r.next=4,(0,$.Yd)(s.path);case 4:u=r.sent,u.success||Z.Z.error({message:"\u5220\u9664\u6587\u4EF6\u9519\u8BEF",description:u.errMsg}),r.next=11;break;case 8:r.prev=8,r.t0=r.catch(1),Z.Z.error({message:"\u672A\u77E5\u9519\u8BEF",description:"".concat(r.t0)});case 11:v(),i(l);case 13:case"end":return r.stop()}},o,null,[[1,8]])})),children:(0,e.jsx)(S.ZP,{icon:(0,e.jsx)(De.Z,{}),danger:!0,type:"text",title:"\u5220\u9664"})})]})})]})}var _e=n(51904),et=n(83266),tt=["dir","beforeRequest","afterRequest","loading"];function nt(t){var s=t.dir,i=t.beforeRequest,l=t.afterRequest,x=t.loading,j=G()(t,tt),g=c.useMemo(function(){return(0,O.Dy)(s,"/","newfolder_".concat(Date.now()%1e3))},[s]),v=c.useState(""),C=P()(v,2),m=C[0],f=C[1];return c.useEffect(function(){f(g)},[g]),(0,e.jsx)(K.Q,{modalProps:{title:"\u65B0\u5EFA\u6587\u4EF6\u5939",okText:"\u521B\u5EFA",okButtonProps:{loading:x}},buttonProps:y()({icon:(0,e.jsx)(et.Z,{}),title:"\u65B0\u5EFA\u6587\u4EF6\u5939",children:"\u65B0\u5EFA\u6587\u4EF6\u5939",loading:x},j),beforeRequest:i,afterRequest:l,request:B()(F()().mark(function o(){return F()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,$.L6)(m);case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}},o)})),children:(0,e.jsx)(M.Z,{value:m,onChange:function(u){var a;return f((u==null||(a=u.target)===null||a===void 0?void 0:a.value)||"")},style:{width:"100%"}})})}var rt=n(56334),st=["pasteType","src","dstDir","loading","beforeRequest","afterRequest"];function at(t){var s=t.pasteType,i=t.src,l=t.dstDir,x=t.loading,j=t.beforeRequest,g=t.afterRequest,v=G()(t,st),C=c.useState(""),m=P()(C,2),f=m[0],o=m[1];return c.useEffect(function(){return o((0,O.Dy)(l,(0,O.Us)((i==null?void 0:i[0])||"")))},[l,i]),(0,e.jsx)(K.Q,{modalProps:{title:"".concat(s==="copy"?"\u590D\u5236":s==="cut"?"\u79FB\u52A8":"\u7C98\u8D34","\u6587\u4EF6"),okText:"\u7C98\u8D34",okButtonProps:{loading:x}},buttonProps:y()({title:"\u7C98\u8D34",children:"\u7C98\u8D34",icon:(0,e.jsx)(rt.Z,{}),loading:x},v),beforeRequest:j,afterRequest:g,request:B()(F()().mark(function u(){var a;return F()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(i.length!==1){h.next=6;break}return h.next=3,(s==="cut"?$.jW:$.cy)(i[0],f);case 3:return h.abrupt("return",h.sent);case 6:return h.next=8,Promise.all(i.map(function(d){return(s==="cut"?$.jW:$.cy)(d,(0,O.Dy)(l,(0,O.Us)(d)))}));case 8:if(a=h.sent,!a.every(function(d){return d.success})){h.next=11;break}return h.abrupt("return",{success:!0});case 11:return h.abrupt("return",{success:!1,errMsg:a.filter(function(d){return!d.success}).map(function(d){return d.success?"":d==null?void 0:d.errMsg}).join(`
`)});case 12:case"end":return h.stop()}},u)})),children:i.length===1?(0,e.jsxs)(R.Z,{direction:"vertical",style:{width:"100%"},children:[(0,e.jsx)(M.Z,{value:i,disabled:!0,style:{width:"100%"},addonBefore:"\u539F\u59CB\u6587\u4EF6"}),(0,e.jsx)(M.Z,{addonBefore:"\u76EE\u6807\u6587\u4EF6",value:f,onChange:function(a){var r;return o((a==null||(r=a.target)===null||r===void 0?void 0:r.value)||"")},style:{width:"100%"}})]}):(0,e.jsx)(L.Z,{header:(0,e.jsx)("b",{children:"\u6587\u4EF6\u5217\u8868"}),style:{maxHeight:200,overflow:"auto",margin:20},size:"small",dataSource:i,renderItem:function(a){return(0,e.jsx)(L.Z.Item,{children:a})}})})}var ut=["files","beforeRequest","afterRequest","loading"];function it(t){var s=t.files,i=t.beforeRequest,l=t.afterRequest,x=t.loading,j=G()(t,ut);return(0,e.jsx)(K.Q,{modalProps:{title:"\u5220\u9664\u6587\u4EF6",okText:"\u786E\u8BA4\u5220\u9664",okButtonProps:{danger:!0,type:"primary",loading:x}},buttonProps:y()({icon:(0,e.jsx)(De.Z,{}),title:"\u6279\u91CF\u5220\u9664",children:"\u6279\u91CF\u5220\u9664",danger:!0,loading:x},j),beforeRequest:i,afterRequest:l,request:B()(F()().mark(function g(){var v;return F()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,Promise.all(s.map(function(){var f=B()(F()().mark(function o(u){return F()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,$.Yd)(u);case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}},o)}));return function(o){return f.apply(this,arguments)}}()));case 2:if(v=m.sent,!v.every(function(f){return f.success})){m.next=5;break}return m.abrupt("return",{success:!0});case 5:return m.abrupt("return",{success:!1,errMsg:v.filter(function(f){return!f.success}).map(function(f){return f.success?"":f==null?void 0:f.errMsg}).join(`
`)});case 6:case"end":return m.stop()}},g)})),children:(0,e.jsx)(L.Z,{header:(0,e.jsx)("b",{children:"\u5220\u9664\u6587\u4EF6\u5217\u8868"}),style:{maxHeight:200,overflow:"auto",margin:20},size:"small",dataSource:s,renderItem:function(v){return(0,e.jsx)(L.Z.Item,{children:v})}})})}var lt=n(19632),be=n.n(lt),ot=n(4393),dt=n(68955),Ee=n(43331),ct=n(64082),ft=n(31365);function vt(t){var s=t.folder,i=J.Z(!1),l=P()(i,2),x=l[0],j=l[1],g=j.setTrue,v=j.setFalse,C=c.useContext(z._);return(0,e.jsx)(R.Z,{direction:"vertical",style:{width:"100%"},styles:{item:{width:"100%"}},children:(0,e.jsxs)(ft.Z.Dragger,{disabled:x,showUploadList:!1,multiple:!0,customRequest:function(){var m=B()(F()().mark(function f(o){var u,a,r;return F()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(o.file){d.next=2;break}return d.abrupt("return");case 2:u=o.file,a=u.name,g(),r=new Ee.Vz(u,s?(0,O.Dy)(s,a):a),r.run(),C.setCtx(function(E){return y()(y()({},E),{},{tasks:[].concat(be()((E==null?void 0:E.tasks)||[]),[r])})}),Z.Z.success({message:"\u5F00\u59CB\u4E0A\u4F20 ".concat((0,O.Us)(a))}),v();case 10:case"end":return d.stop()}},f)}));return function(f){return m.apply(this,arguments)}}(),children:[(0,e.jsx)(ct.Z,{style:{fontSize:18,marginRight:"0.5em"}}),"\u62D6\u62FD\u6216\u9009\u62E9\u6587\u4EF6\uFF0C\u652F\u6301\u591A\u9009\u3002\u5982\u679C\u9700\u8981\u4E0A\u4F20\u6587\u4EF6\u5939\u8BF7\u538B\u7F29\u4E3A zip \u540E\u4E0A\u4F20\u3002"]})})}var ht=n(25864),Ae=n(50888),Me=n(88484);function gt(t){var s=t.folder,i=t.url,l=t.filename,x=t.region,j=t.unzip,g=j===void 0?!1:j,v=c.useState(i||""),C=P()(v,2),m=C[0],f=C[1],o=c.useState(""),u=P()(o,2),a=u[0],r=u[1];c.useEffect(function(){r((0,O.Dy)(s,""))},[s]);var h=J.Z(!1),d=P()(h,2),E=d[0],_=d[1],Fe=_.setTrue,ie=_.setFalse,le=c.useMemo(function(){return a.trim()?s||/^(\/mnt\/.+)|(^\/tmp\/.+)/.test(a)?"":"\u6587\u4EF6\u53EA\u5141\u8BB8\u4E0A\u4F20\u81F3 /mnt/ \u53CA /tmp/ \u76EE\u5F55":"\u6587\u4EF6\u540D\u4E0D\u80FD\u4E3A\u7A7A"},[a]),N=c.useMemo(function(){return m.indexOf("oss-".concat(x,".aliyuncs.com"))!==-1?m.replace("oss-".concat(x,".aliyuncs.com"),"oss-".concat(x,"-internal.aliyuncs.com")):""},[m]),H=c.useState(!1),oe=P()(H,2),de=oe[0],Y=oe[1];c.useEffect(function(){N&&Y(!0)},[N]);var ce=c.useContext(z._);return(0,e.jsxs)(R.Z,{direction:"vertical",style:{width:"100%"},children:[(0,e.jsx)(Be.Z,{title:"\u662F\u5426\u5207\u6362\u4E3A\u963F\u91CC\u4E91\u5185\u7F51\u94FE\u63A5\uFF1F",description:(0,e.jsxs)("span",{children:["\u8FD9\u53EF\u4EE5\u907F\u514D\u4EA7\u751F\u6D41\u91CF\u8D39\u7528\uFF0C\u5E76\u4E14\u52A0\u5FEB\u4E0B\u8F7D\u901F\u5EA6\u3002",(0,e.jsx)("br",{}),"\u5185\u7F51\u94FE\u63A5: ",N]}),trigger:[],open:de,onCancel:function(){return Y(!1)},onOpenChange:function(k){return Y(k)},onConfirm:function(){f(N),Y(!1)},children:(0,e.jsx)(M.Z,{addonBefore:"\u6587\u4EF6\u5730\u5740",value:m,disabled:E||!!i,placeholder:"https://xxxx.com/xxx.model",suffix:(0,e.jsx)("span",{children:E&&(0,e.jsx)(Ae.Z,{})}),onChange:function(k){var p;return typeof((p=k.target)===null||p===void 0?void 0:p.value)!="undefined"&&f(k.target.value.trim())}})}),(0,e.jsxs)(R.Z.Compact,{style:{width:"100%"},children:[(0,e.jsx)(M.Z,{value:a,disabled:E||!!l,addonBefore:"\u6587\u4EF6\u540D",suffix:(0,e.jsx)("span",{children:E&&(0,e.jsx)(Ae.Z,{})}),onChange:function(k){var p;return typeof((p=k.target)===null||p===void 0?void 0:p.value)!="undefined"&&r(k.target.value)},placeholder:"\u8BF7\u8F93\u5165\u6587\u4EF6\u540D"}),(0,e.jsx)(S.ZP,{type:"primary",icon:(0,e.jsx)(Me.Z,{}),disabled:E||!!le,onClick:B()(F()().mark(function I(){var k;return F()().wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:Fe(),k=new(g?Ee.qU:Ee.tw)(m,a),k.run(),ce.setCtx(function(Q){return y()(y()({},Q),{},{tasks:[].concat(be()((Q==null?void 0:Q.tasks)||[]),[k])})}),Z.Z.success({message:"\u5F00\u59CB\u4E0B\u8F7D ".concat((0,O.Us)(a))}),ie();case 6:case"end":return ee.stop()}},I)})),children:"\u4E0A\u4F20"})]})]})}function pt(t){var s=ahooks.useCounter(0),i=_slicedToArray(s,2),l=i[0],x=i[1].inc,j=React.useState([l]),g=_slicedToArray(j,2),v=g[0],C=g[1];return _jsx(Space,{direction:"vertical",style:{width:"100%"},children:_jsx(List,{style:{maxHeight:"60vh",overflow:"auto"},dataSource:v,header:_jsxs(Space,{direction:"horizontal",style:{width:"100%",justifyContent:"space-between"},align:"end",children:[_jsx("div",{children:t.extra}),_jsx(Button,{type:"primary",icon:_jsx(PlusOutlined,{}),onClick:function(){x(),C(function(f){return[].concat(_toConsumableArray(f),[l])})}})]}),renderItem:function(f){return _jsx(List.Item,{actions:[_jsx(Button,{icon:_jsx(DeleteOutlined,{}),danger:!0,onClick:function(){C(v.filter(function(u){return u!==f}))}})],children:t.children})}})})}function mt(t){var s=t.folder,i=t.region,l=t.extra,x=c.useState("chunk"),j=P()(x,2),g=j[0],v=j[1];return(0,e.jsx)(ot.Z,{children:(0,e.jsxs)(R.Z,{direction:"vertical",style:{width:"100%"},children:[(0,e.jsx)(dt.Z,{activeKey:g,items:[{key:"chunk",label:"\u5206\u7247\u4E0A\u4F20",children:(0,e.jsx)(vt,{folder:s})},{key:"url",label:"\u79BB\u7EBF\u4E0A\u4F20",children:(0,e.jsx)(gt,{folder:s,region:i})}],onChange:v}),(0,e.jsx)("div",{style:{maxHeight:300,overflowY:"auto",padding:20,overflowX:"hidden"},children:(0,e.jsx)(ht.E,{})})]})})}var xt=["currentPath","region"];function jt(t){var s=t.currentPath,i=t.region,l=G()(t,xt);return(0,e.jsx)(K.Q,{modalProps:{title:"\u4E0A\u4F20\u6587\u4EF6",style:{minWidth:800}},buttonProps:y()({icon:(0,e.jsx)(Me.Z,{}),children:"\u4E0A\u4F20",title:"\u4E0A\u4F20"},l),children:(0,e.jsx)(mt,{folder:(0,O.Dy)(s,"/"),region:i})})}var Ct=["files","dir","loading","beforeRequest","afterRequest"];function Et(t){var s=t.files,i=t.dir,l=t.loading,x=t.beforeRequest,j=t.afterRequest,g=G()(t,Ct),v=c.useMemo(function(){return(0,O.Dy)(i,"/","".concat((0,O.Us)(i),".zip"))},[i]),C=c.useState(""),m=P()(C,2),f=m[0],o=m[1];return c.useEffect(function(){o(v)},[v]),(0,e.jsxs)(K.Q,{modalProps:{title:"\u538B\u7F29\u6587\u4EF6",okText:"\u5F00\u59CB\u538B\u7F29",okButtonProps:{loading:l}},buttonProps:y()({icon:(0,e.jsx)($e.Z,{}),title:"\u538B\u7F29\u6587\u4EF6",children:"\u538B\u7F29 ZIP \u5305",loading:l},g),beforeRequest:x,afterRequest:j,request:B()(F()().mark(function u(){return F()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,$.$R)(s,f);case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}},u)})),children:[(0,e.jsx)(L.Z,{header:(0,e.jsx)("b",{children:"\u538B\u7F29\u6587\u4EF6\u5217\u8868"}),style:{maxHeight:200,overflow:"auto",margin:20},size:"small",dataSource:s,renderItem:function(a){return(0,e.jsx)(L.Z.Item,{children:a})}}),(0,e.jsx)(M.Z,{addonBefore:"\u538B\u7F29\u6587\u4EF6\u540D",value:f,onChange:function(a){var r;return o((a==null||(r=a.target)===null||r===void 0?void 0:r.value)||"")},style:{width:"100%"}})]})}function Ft(t){var s,i=t.region,l=t.currentPath,x=t.loading,j=t.setLoading,g=t.setLoadingFinished,v=t.cache,C=t.setCache,m=t.showDirSize,f=t.setShowDirSize,o=t.run,u=t.files,a=t.setSelectedFiles,r=t.selectedFiles;return(0,e.jsxs)(R.Z,{direction:"vertical",style:{width:"100%"},children:[(0,e.jsx)(R.Z,{wrap:!0,children:[{path:"/mnt/auto/sd",label:"sd \u6839\u76EE\u5F55"},{path:"/mnt/auto/sd/models/Stable-diffusion",label:"sd \u57FA\u7840\u6A21\u578B(checkpoint)\u76EE\u5F55"},{path:"/mnt/auto/sd/models/Lora",label:"LoRA \u76EE\u5F55"},{path:"/mnt/auto/sd/extensions",label:"\u63D2\u4EF6\u76EE\u5F55"},{path:"/mnt/auto/sd/models/ControlNet",label:"ControlNet \u76EE\u5F55"},{path:"/mnt/auto/sd/outputs",label:"\u56FE\u7247\u751F\u6210\u76EE\u5F55"}].map(function(h){return(0,e.jsx)(_e.Z,{style:{cursor:"pointer"},onClick:function(){return o(h.path)},children:h.label},h.label)})}),(0,e.jsxs)(R.Z,{style:{justifyContent:"space-between",width:"100%"},wrap:!0,children:[(0,e.jsxs)(R.Z,{wrap:!0,children:[r.length===0?(0,e.jsx)(S.ZP,{onClick:function(){return a(u.reduce(function(d,E){return y()(y()({},d),{},U()({},E.path,!0))},{}))},children:"\u5168\u9009"}):(0,e.jsx)(S.ZP,{onClick:function(){return a({})},children:"\u53D6\u6D88\u9009\u62E9"}),(0,e.jsx)(S.ZP,{onClick:function(){return a(y()(y()({},u.reduce(function(d,E){return y()(y()({},d),{},U()({},E.path,!0))},{})),r.reduce(function(d,E){return y()(y()({},d),{},U()({},E,!1))},{})))},children:"\u53CD\u9009"}),(0,e.jsx)(Et,{files:r,dir:l,disabled:!(r!=null&&r.length),loading:x,beforeRequest:j,afterRequest:function(d,E){d?Z.Z.success({message:"\u538B\u7F29\u6210\u529F"}):Z.Z.error({message:"\u538B\u7F29\u5931\u8D25",description:E}),g(),o(l)}}),(0,e.jsx)(S.ZP,{icon:(0,e.jsx)(pe.Z,{}),disabled:!(r!=null&&r.length),onClick:function(){return C({file:r,type:"cut"})},children:"\u6279\u91CF\u526A\u5207"}),(0,e.jsx)(S.ZP,{icon:(0,e.jsx)(Pe.Z,{}),disabled:!(r!=null&&r.length),onClick:function(){return C({file:r,type:"copy"})},children:"\u6279\u91CF\u590D\u5236"}),(0,e.jsx)(it,{files:r,disabled:!(r!=null&&r.length),loading:x,beforeRequest:j,afterRequest:function(d,E){d?Z.Z.success({message:"\u6279\u91CF\u5220\u9664\u6210\u529F"}):Z.Z.error({message:"\u6279\u91CF\u5220\u9664\u5931\u8D25",description:E}),g(),o(l)}})]}),(0,e.jsxs)(R.Z,{wrap:!0,children:[(0,e.jsx)(Se.Z,{checked:m,onChange:function(d){var E;return f((d==null||(E=d.target)===null||E===void 0?void 0:E.checked)||!1)},children:"\u8BA1\u7B97\u6587\u4EF6\u5939\u5927\u5C0F"}),(0,e.jsx)(nt,{loading:x,dir:l,beforeRequest:j,afterRequest:function(d,E){d?Z.Z.success({message:"\u521B\u5EFA\u6587\u4EF6\u5939\u6210\u529F"}):Z.Z.error({message:"\u521B\u5EFA\u6587\u4EF6\u5939\u5931\u8D25",description:E}),g(),o(l)}}),(0,e.jsx)(at,{disabled:!v||!(v!=null&&(s=v.file)!==null&&s!==void 0&&s.length),pasteType:(v==null?void 0:v.type)||"copy",src:(v==null?void 0:v.file)||[],dstDir:l,loading:x,beforeRequest:j,afterRequest:function(d,E){d?Z.Z.success({message:"\u7C98\u8D34\u6210\u529F"}):Z.Z.error({message:"\u7C98\u8D34\u5931\u8D25",description:E}),g(),o(l)}}),(0,e.jsx)(jt,{currentPath:l,region:i})]})]})]})}function Rt(){var t=c.useState("/mnt/auto"),s=P()(t,2),i=s[0],l=s[1],x=c.useState(i),j=P()(x,2),g=j[0],v=j[1],C=c.useState(!1),m=P()(C,2),f=m[0],o=m[1],u=c.useRef({isFirst:!0,refresh:function(){}}),a=D.Z(function(){var A=B()(F()().mark(function b(T){var X,fe;return F()().wrap(function(q){for(;;)switch(q.prev=q.next){case 0:return q.next=2,(0,$.C7)(T,f);case 2:return X=q.sent,X.success||Z.Z.error({message:"\u76EE\u5F55\u4E0D\u5B58\u5728",description:"\u76EE\u5F55 ".concat(T," \u4E0D\u5B58\u5728\uFF0C\u8FD9\u53EF\u80FD\u662F\u56E0\u4E3A\u60A8\u9996\u6B21\u4F7F\u7528\u8FD8\u672A\u521B\u5EFA\u6539\u76EE\u5F55\u3002\u8BE6\u7EC6\u4FE1\u606F\uFF1A").concat(X.errMsg)}),fe=X.files||[],v(T),l(T),q.abrupt("return",fe.sort(function(ye,Ze){return ye.is_dir&&!Ze.is_dir?-1:!ye.is_dir&&Ze.is_dir?1:ye.name.localeCompare(Ze.name)}));case 8:case"end":return q.stop()}},b)}));return function(b){return A.apply(this,arguments)}}(),{retryCount:3,manual:!0,refreshDeps:[f]}),r=a.data,h=a.loading,d=a.run;c.useEffect(function(){u.current.refresh=function(){return d(i)}},[d,i]);var E=J.Z(!1),_=P()(E,2),Fe=_[0],ie=_[1],le=ie.setTrue,N=ie.setFalse,H=h||Fe,oe=c.useState(void 0),de=P()(oe,2),Y=de[0],ce=de[1],I=c.useCallback(function(){var A=document.getElementById("scrollableDiv");A&&(A.style.height="".concat(window.innerHeight-A.offsetTop-50,"px"))},[]);c.useEffect(function(){return I()},[]),je.Z("resize",I);var k=c.useContext(z._),p=k.info;c.useEffect(function(){u.current.refresh()},[u,f]),c.useEffect(function(){u.current.isFirst&&((p==null?void 0:p.withNas)===!1?(Z.Z.warning({message:"\u672A\u6302\u8F7D NAS",description:"\u8BF7\u5728\u8BBE\u7F6E\u4E2D\u6302\u8F7D NAS \u540E\u4F7F\u7528"}),u.current.isFirst=!1):(p==null?void 0:p.withNas)===!0&&(d(i),u.current.isFirst=!1))},[p==null?void 0:p.withNas,f,d]);var ee=c.useState({}),Q=P()(ee,2),te=Q[0],Re=Q[1];c.useEffect(function(){Re({})},[g]);var Zt=c.useMemo(function(){return Object.entries(te).filter(function(A){var b=P()(A,2),T=b[1];return T}).map(function(A){var b=P()(A,1),T=b[0];return T})},[te]);return(0,e.jsx)(ae.r,{disabled:!(p!=null&&p.withNas),children:(0,e.jsxs)(R.Z,{direction:"vertical",style:{width:"100%"},styles:{item:{width:"100%"}},children:[(0,e.jsxs)(R.Z.Compact,{style:{width:"100%"},children:[(0,e.jsx)(M.Z,{value:i,onChange:function(b){var T;return l((b==null||(T=b.target)===null||T===void 0?void 0:T.value)||"")},onKeyDown:function(b){b.key==="Enter"&&d(i)}}),(0,e.jsx)(S.ZP,{type:"primary",icon:(0,e.jsx)(se.Z,{}),loading:H,onClick:function(){return d(i)}}),(0,e.jsx)(S.ZP,{icon:(0,e.jsx)(xe.Z,{}),loading:H,onClick:function(){return d(g.split("/").reverse().slice(1).reverse().join("/")||"/")}})]}),(0,e.jsx)(Ft,{region:(p==null?void 0:p.region)||"public",currentPath:g,loading:H,setLoading:le,setLoadingFinished:N,cache:Y,setCache:ce,showDirSize:f,setShowDirSize:o,run:d,selectedFiles:Zt,setSelectedFiles:Re,files:r||[]}),(0,e.jsx)("div",{id:"scrollableDiv",style:{height:800,overflow:"auto",padding:"0 16px",border:"1px solid rgba(140, 140, 140, 0.35)",background:"white"},children:(0,e.jsx)(L.Z,{dataSource:r,loading:H,size:"small",renderItem:function(b){return(0,e.jsx)(L.Z.Item,{children:(0,e.jsx)(Je,{file:b,run:d,currentPath:g,showDirSize:f,loading:H,setLoading:le,setLoadingFinished:N,setCache:ce,selected:!!(te!=null&&te[b.path]),onSelect:function(X){Re(function(fe){return y()(y()({},fe),{},U()({},b.path,X))})}})})}})})]})})}function yt(){return(0,e.jsx)("div",{style:{padding:20,height:"100%"},children:(0,e.jsx)(Rt,{})})}}}]);
